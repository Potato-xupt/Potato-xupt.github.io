<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.2.0',
    sidebar: {"position":"left","width":250,"display":"post","offset":12,"onmobile":true,"dimmer":true},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="详细介绍了HTTP相关的细节和技术，如HTTP的状态码、与Web服务器交互时使用到的技术、首部字段HTTPS以及HTTP各个版本之间的区别等等内容。">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP详解">
<meta property="og:url" content="http://yoursite.com/posts/62018/index.html">
<meta property="og:site_name" content="Potato Blog">
<meta property="og:description" content="详细介绍了HTTP相关的细节和技术，如HTTP的状态码、与Web服务器交互时使用到的技术、首部字段HTTPS以及HTTP各个版本之间的区别等等内容。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210305.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210332.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210400.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210433.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103213849.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103213913.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103214424.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103214525.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103215501.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103215748.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103220121.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103221113.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191104221710.png">
<meta property="og:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191106180112.png">
<meta property="og:updated_time" content="2019-11-06T10:34:35.868Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP详解">
<meta name="twitter:description" content="详细介绍了HTTP相关的细节和技术，如HTTP的状态码、与Web服务器交互时使用到的技术、首部字段HTTPS以及HTTP各个版本之间的区别等等内容。">
<meta name="twitter:image" content="http://yoursite.com/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210305.png">



  <link rel="alternate" href="/atom.xml" title="Potato Blog" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://yoursite.com/posts/62018/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>HTTP详解 | Potato Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Potato Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">李土豆的Blog</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">7</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于我</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
    
  
  

  

  <article class="post post-type-normal true" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/posts/62018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Potato">
      <meta itemprop="description" content="Although the road is endless and faraway, I still want to pursue the truth in the world.">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Potato Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">HTTP详解

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-11-03 17:01:41" itemprop="dateCreated datePublished" datetime="2019-11-03T17:01:41+08:00">2019-11-03</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-11-06 18:34:35" itemprop="dateModified" datetime="2019-11-06T18:34:35+08:00">2019-11-06</time>
              </span>
            
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机网络/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
		  
		  

          <br>
          

          

          
            <div class="post-description">详细介绍了HTTP相关的细节和技术，如HTTP的状态码、与Web服务器交互时使用到的技术、首部字段HTTPS以及HTTP各个版本之间的区别等等内容。</div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="HTTP状态码"><a href="#HTTP状态码" class="headerlink" title="HTTP状态码"></a>HTTP状态码</h1><p>状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。借助状态码，用户可以知道服务器端是正常处理了请求，还是出现了错误。</p>
<p>状态码如：200 OK，以3位数字和原因短语组成。数字中第一位指定了响应类别，后两位无分类。响应类别有以下5种：</p>
<table>
<thead>
<tr>
<th align="center">状态码</th>
<th align="center">类别</th>
<th align="center">原因短语</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1XX</td>
<td align="center">Informational（信息性状态码）</td>
<td align="center">接收的请求正在处理</td>
</tr>
<tr>
<td align="center">2XX</td>
<td align="center">Success（成功状态码）</td>
<td align="center">请求正常处理完毕</td>
</tr>
<tr>
<td align="center">3XX</td>
<td align="center">Redirection（重定向状态码）</td>
<td align="center">需要进行附加操作以完成请求</td>
</tr>
<tr>
<td align="center">4XX</td>
<td align="center">Client Error（客户端错误状态码）</td>
<td align="center">服务器无法处理请求</td>
</tr>
<tr>
<td align="center">5XX</td>
<td align="center">Server Error（服务器错误状态码）</td>
<td align="center">服务器处理请求出错</td>
</tr>
</tbody></table>
<h2 id="2XX成功"><a href="#2XX成功" class="headerlink" title="2XX成功"></a>2XX成功</h2><p><strong>2XX的响应结果表明请求被正常处理了。</strong></p>
<ul>
<li><strong>200 OK</strong>： <strong>表示从客户端发来的请求在服务器端被正常处理了。</strong>在响应报文内，随状态码一起返回的信息会因方法定不同而发生改变。比如，使用GET方法时，对应请求资源的实体会作为响应返回；而使用HEAD方法时，对应请求资源的实体主体不随报文首部作为响应返回。</li>
<li><strong>204 No Content</strong>：<strong>该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。另外，也不允许返回任何实体的主体。</strong>一般在只需从客户端往服务器发送信息，而对客户端不需要发送新信息内容的情况下使用。</li>
<li><strong>206 Partial Content</strong>：<strong>该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的GET请求。响应报文中包含由Content-Range指定范围的实体内容。</strong></li>
</ul>
<h2 id="3XX重定向"><a href="#3XX重定向" class="headerlink" title="3XX重定向"></a>3XX重定向</h2><p><strong>3XX响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。</strong></p>
<ul>
<li><strong>301 Moved Permanently</strong>：<strong>永久性重定向。</strong>该状态码表示请求的资源已被分配了新的URI，以后应使用资源现在所指的URI。也就是说，如果已经把资源对应的URI保存为书签了，这时应该按Location首部字段提示的URI重新保存。</li>
<li><strong>302 Found</strong>：<strong>临时性重定向。</strong>该状态码表示请求的资源已被分配了新的URI，希望用户（本次）能使用新的URI访问。和301 Moved Permanently状态码相似，但302状态码代表的资源不是被永久移动。</li>
<li><strong>303 See Other</strong>：<strong>该状态码表示由于请求对应的资源存在着另一个URI，应使用GET方法定向获取请求的资源。</strong>303状态码和302 Found状态码有着相同的功能，<strong>但303状态码明确表示客户端应当采用GET方法获取资源，</strong>这点与302状态码有所区别。</li>
</ul>
<p><strong>当301、302、303响应状态码返回时，几乎所有的浏览器都会把POST改成GET，并删除请求报文内的主体，之后请求会自动再次发送。</strong></p>
<ul>
<li><strong>304 Not Modified</strong>：<strong>该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但因发生请求未满足条件的情况后，直接返回304 Not Modified（服务器端资源未改变，可直接使用客户端未过期的缓存）。304状态码返回时，不包含任何响应的主体部分。304虽然被划分在3XX类别中，但是和重定向没有任何关系。</strong></li>
<li><strong>307 Temporary Redirect</strong>：<strong>临时重定向</strong>，该状态码与302 Found有着相同的含义。尽管302标准禁止POST变换成GET，但实际使用时大家并不遵守。<strong>307会遵照浏览器标准，不会从POST变成GET。</strong></li>
</ul>
<h2 id="4XX客户端错误"><a href="#4XX客户端错误" class="headerlink" title="4XX客户端错误"></a>4XX客户端错误</h2><p><strong>4XX的响应结果表明客户端是发生错误的原因所在。</strong></p>
<ul>
<li><strong>400 Bad Request</strong>：<strong>该状态码表示请求报文中存在语法错误。</strong>当错误发生时，需修改请求的内容再次发送请求。另外。浏览器会像200 OK一样对待该状态码。</li>
<li><strong>401 Unauthorized</strong>：<strong>该状态码表示发送的请求需要有通过HTTP认证的信息。另外若之前已进行过1次请求，则表示用户认证失败。</strong>返回含有401的响应必须包含一个是用于被请求资源的WWW Authenticate首部用以质询用户信息。当浏览器初次接收到401响应，会弹出认证用的对话窗口。</li>
<li><strong>403 Forbidden</strong>：<strong>该状态码表明对请求资源的访问被服务器拒绝了。</strong>服务器端没有必要给出拒绝的详细理由，但如果想做说明的话，可以在实体的主体部分对原因进行描述，这样就能让用户看到了。</li>
<li><strong>404 Not Found</strong>：<strong>该状态码表明服务器上无法找到请求的资源。</strong>除此之外，也可以在服务器端拒绝请求且不想说明理由时使用。</li>
</ul>
<h2 id="5XX服务器错误"><a href="#5XX服务器错误" class="headerlink" title="5XX服务器错误"></a>5XX服务器错误</h2><p><strong>5XX的响应结果表明服务器本身发生错误。</strong></p>
<ul>
<li><strong>500 Internal Server Error</strong>：<strong>该状态码表明服务器端在执行请求时发生了错误。</strong>也有可能是Web应用存在bug或某些临时错误的故障。</li>
<li><strong>503 Service Unavailable</strong>：<strong>该状态码表明服务器暂时处于超负载状态或正在进行停机维护，现在无法处理请求。</strong>如果事先得知解除以上状况需要的时间，最好写入RetryAfter 首部字段再返回给客户端。</li>
</ul>
<h1 id="与HTTP协作的Web服务器"><a href="#与HTTP协作的Web服务器" class="headerlink" title="与HTTP协作的Web服务器"></a>与HTTP协作的Web服务器</h1><p>HTTP通信时，除客户端和服务器以外，还有一些用于通信数据转发的应用程序，例如代理、网关和隧道。它们可以配合服务器工作。这些应用程序和服务器可以将请求转发给通信线路上的下一站服务器，并且能接收从那台服务器发送的响应再转发给客户端。</p>
<ul>
<li><strong>代理</strong>：<strong>代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，</strong>接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。</li>
<li><strong>网关</strong>：<strong>网关是转发其他服务器通信数据的服务器，</strong>接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。</li>
<li><strong>隧道</strong>：<strong>隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。</strong></li>
</ul>
<h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><p><strong>代理服务器的基本行为就是接收客户端发送的请求后，转发给其他服务器。代理不改变请求URI，会直接发送给前方持有资源的目标服务器。</strong></p>
<p>持有资源实体的服务器被称为源服务器，从源服务器返回的响应经过代理服务器后再传给客户端。</p>
<p><strong>在HTTP通信过程中，可级联多台代理服务器。</strong>请求和响应的转发会经过数台类似锁链一样连接起来的代理服务器。<strong>转发时，需要附加Via首部字段以标记出经过的主机信息。</strong></p>
<p>使用代理服务器的理由有：<strong>利用缓存技术减少网络带宽的流量，组织内部针对特定网站的访问控制，以获取访问日志为主要目的，</strong>等等。</p>
<p>代理有多种使用方法，按两种基准分类：<strong>一种是是否使用缓存，另一种是是否会修改报文。</strong></p>
<ul>
<li><strong>缓存代理</strong>：代理转发响应时，<strong>缓存代理会预先将资源的副本（缓存）保存在代理服务器上</strong>。当代理再次接收到对相同资源的请求时，就可以不从源服务器那里获取资源，而是将之前缓存的资源作为响应返回。</li>
<li><strong>透明代理</strong>：转发请求或响应时，<strong>不对报文做任何加工的代理类型被称为透明代理</strong>。反之，对报文内容进行加工的代理被称为非透明代理。</li>
</ul>
<h2 id="网关"><a href="#网关" class="headerlink" title="网关"></a>网关</h2><p>网关的工作机制和代理十分相似，而<strong>网关能使通信线路上的服务器提供非HTTP协议服务。</strong></p>
<p>利用网关能提高通信的安全性，因为可以在客户端与网关之间的通信线路上加密以确保连接的安全。比如，网关可以连接数据库，使用SQL语句查询数据。另外，在Web购物网站上进行信用卡结算时，网管可以和信用卡结算系统联动。</p>
<h2 id="隧道"><a href="#隧道" class="headerlink" title="隧道"></a>隧道</h2><p><strong>隧道可按要求建立起一条与其他服务器的通信线路，届时使用SSL等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的通信。</strong></p>
<p><strong>隧道本身不会去解析HTTP请求，也就是说，请求保持原样中转给之后的服务器。隧道会在通信双方断开连接时结束。</strong></p>
<h2 id="保存资源的缓存"><a href="#保存资源的缓存" class="headerlink" title="保存资源的缓存"></a>保存资源的缓存</h2><p><strong>缓存是指代理服务器或客户端本地磁盘内保存的资源副本。利用缓存可减少对源服务器的访问，因此也就节省了通信流量和通信时间。</strong></p>
<p>缓存服务器是代理服务器的一种，并归类在缓存代理类型中。换句话说，当代理转发从服务器返回的响应时，代理服务器将会保存一份资源的副本。</p>
<p>缓存服务器的优势在于利用缓存可避免多次从源服务器转发资源。因此客户端可就近从缓存服务器上获取资源，而源服务器也不必多次处理相同的请求了。</p>
<ul>
<li><strong>缓存的有效期限</strong>：当遇上源服务器上的资源更新时，如果还使用不变的缓存 ，那就会演变成返回更新前的“旧”资源了。<strong>即使存在缓存，也会因为客户端的要求、缓存的有效期等因素，向源服务器确认资源的有效性。若判断缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。</strong></li>
<li><strong>客户端的缓存</strong>：缓存不仅可以存在于缓存服务器内，还可以存在客户端浏览器中。浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直接从本地磁盘内读取。另外，和缓存服务器相同的一点是，当判定缓存过期后，会向源服务器确认资源的有效性。若判断浏览器缓存失效，浏览器会再次请求新资源。</li>
</ul>
<h1 id="HTTP首部"><a href="#HTTP首部" class="headerlink" title="HTTP首部"></a>HTTP首部</h1><p>HTTP协议的请求和响应报文中必定包含HTTP首部，首部内容为客户端和服务器分别处理请求和响应提供所需要的信息。对于客户端用户来说，这些信息中的大部分内容都无须亲自查看。</p>
<p>HTTP首部字段是构成HTTP报文的要素之一。在客户端与服务器之间以HTTP协议进行通信的过程中，无论是请求还是响应都会使用首部字段，它能起到传递额外重要信息的作用。使用首部字段是为了给浏览器和服务器提供报文主体大小、所使用的语言、认证信息等内容。</p>
<p>HTTP首部字段是由首部字段名和字段值构成的，中间用冒号“：”分割。<code>首部字段名：字段值</code>。对于字段值对应单个HTTP首部字段可以有多个值：<code>Keep-Alive：timeout=15，max=100</code></p>
<p>HTTP首部字段根据实际用途被分为以下4种类型：</p>
<ul>
<li><strong>通用首部字段</strong>：请求报文和响应报文两方都会使用的首部。</li>
<li><strong>请求首部字段</strong>：从客户端向服务端发送请求报文时使用的首部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。</li>
<li><strong>响应首部字段</strong>：从服务器端向客户端返回响应报文时使用的首部。补充了相应的附加内容，也会要求客户端附加额外的内容信息。</li>
<li><strong>实体首部字段</strong>：针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更新时间等与实体有关的信息。</li>
</ul>
<p>下面是HTTP/1.1首部字段一览，共47种：</p>
<ul>
<li><strong>通用首部字段：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210305.png" alt></li>
<li><strong>请求首部字段：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210332.png" alt></li>
<li><strong>响应首部字段：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210400.png" alt></li>
<li><strong>实体首部字段：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103210433.png" alt></li>
</ul>
<h2 id="通用首部字段"><a href="#通用首部字段" class="headerlink" title="通用首部字段"></a>通用首部字段</h2><p>通用首部字段是指，请求报文和响应报文双方都会使用的首部。</p>
<h3 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h3><p><strong>通过指定首部字段Cache-Control的指令，就能操作缓存的工作机制。</strong>指令的参数是可选的，多个指令之间通过“，”分隔。首部字段Cache-Control的指令可用于请求及时响应。下面是Cache-Control指令一览：</p>
<ul>
<li><strong>缓存请求指令：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103213849.png" alt></li>
<li><strong>缓存响应指令：</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103213913.png" alt></li>
</ul>
<h3 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h3><p>Connection首部字段具备如下两个作用：</p>
<ul>
<li><strong>控制不再转发给代理的首部字段</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103214424.png" alt>在客户端发送请求和服务器返回响应内，使用Connectioin首部字段，可控制不再转发给代理的首部字段。</li>
<li><strong>管理持久连接</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103214525.png" alt>HTTP/1.1版本的默认连接都是持久连接。为此，客户端会在持久连接上连续发送请求。<strong>当服务器端想明确断开连接时，则指定Connection首部字段的值为Close。</strong>HTTP/1.1之前的HTTP版本的默认连接都是非持久连接。为此如果想在旧版本的HTTP协议上维持持久连接，则需要<strong>指定Connection首部字段的值为Keep-Alive。</strong>服务器就会如图上一样加上首部字段Keep-Alive及首部字段Connection后返回响应。</li>
</ul>
<h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><p><strong>首部字段Date表明创建HTTP报文的日期和时间。</strong>HTTP/1.1协议规定的日期时间的格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Date: Tue, 03 Jul 2012 04:40:59 GMT</span><br></pre></td></tr></table></figure>

<h3 id="Pragma"><a href="#Pragma" class="headerlink" title="Pragma"></a>Pragma</h3><p>Pragma时HTTP/1.1之前版本的历史遗留字段，仅作为与HTTP/1.0的向后兼容而定义。该首部字段只用在客户端发送的请求中。客户端会要求所有的中间服务器不返回缓存的资源。<strong>HTTP/1.1完全可以使用Cache-Control：no-cache代替。</strong></p>
<h3 id="Trailer"><a href="#Trailer" class="headerlink" title="Trailer"></a>Trailer</h3><p><strong>首部字段Trailer会事先说明在报文主体后记录了哪些首部字段。该首部字段可应用在HTTP/1.1版本分块传输编码时。</strong><br><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103215501.png" alt><br>上图中，指定首部字段Trailer的值为Expires，在报文主体之后出现了首部字段Expires。</p>
<h3 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h3><p><strong>首部字段Transfer-Encoding规定了传输报文主体时采用的编码方式。HTTP/1.1的传输编码方式仅对分块传输编码有。效</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103215748.png" alt><br>上图正证如在首部字段Transfer-Encoding中指定的那样，有效使用分块传输编码，且分别被分成3312字节和914字节大小的分块数据。</p>
<h3 id="Upgrade"><a href="#Upgrade" class="headerlink" title="Upgrade"></a>Upgrade</h3><p><strong>首部字段Upgrade用于检测HTTP协议及其他协议是否可使用更高的版本进行通信，其参数可以用来指定一个完全不同的通信协议。</strong><img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103220121.png" alt></p>
<p>如上图，<strong>使用首部字段Upgrade时，还需要额外指定Connection：Upgrade。对于附有首部字段Upgrade的请求，服务器可用101 Switching Protocols状态码作为响应返回。</strong></p>
<h3 id="Via"><a href="#Via" class="headerlink" title="Via"></a>Via</h3><p><strong>使用首部字段Via是为了追踪客户端与服务器端之间的请求和响应报文的传输路径。报文经过代理或网关时，会现在首部字段Via中附加该服务器的信息，然后再进行转发。</strong></p>
<p><strong>首部字段Via不仅用于追踪报文的转发，还可避免请求回环的发生。所以必须在经过代理时附加该首部字段内容。</strong></p>
<p>Via首部是为了追踪传输路径，所以经常会和TRACE方法一起使用。比如，代理服务器接收到由TRACE方法发送过来的请求时，其中Max-Forward：0，代理服务器就不能再转发该请求了。这种情况下，代理服务器会将自身的信息附加到Via首部后，返回该去请求的响应。</p>
<h3 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h3><p>HTTP/1.1的Warning首部是从HTTP/1.0的响应首部（Retry-After）演变来的。<strong>该首部通常会告知用户一些与缓存相关的问题的警告。</strong>Warning首部的格式如下，最后的日期时间部分可省略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Warning: [警告码][警告的主机:端口号]“[警告内容]”([日期时间])</span><br></pre></td></tr></table></figure>

<p>HTTP/1.1中定义了7种警告，警告码对应的警告内容可如下参考：<img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191103221113.png" alt></p>
<h2 id="请求首部字段"><a href="#请求首部字段" class="headerlink" title="请求首部字段"></a>请求首部字段</h2><p>请求首部字段是从客户端往服务器端发送请求报文中所使用的字段，用于补充请求的附加信息、客户端信息、对响应内容相关的优先级等内容。</p>
<ul>
<li><strong>Accept</strong>：<strong>Accept首部字段可通知服务器,用户代理能够处理的媒体类型及媒体类型的相对优先级。</strong>可使用type/subtype这种形式，一次指定多种媒体类型。例如，文本文件：text/html，text/plain；图片文件：image/png等等。若想要给显式的媒体类型增加优先级，则使用q=来额外表示权重值，用分号“;”进行分隔。权重范围为0~1，默认为1。</li>
<li><strong>Accept-Charset</strong>：<strong>该首部字段可用来通知服务器用户代理支持的字符集及字符集的相对优先顺序。</strong>另外，可一次性指定多种字符集。与首部字段Accept相同的是可以使用权重。</li>
<li><strong>Accept-Encoding</strong>：<strong>Accent-Encoding首部字段可用来告知服务器用户代理支持的内容编码及内容编码的优先级顺序，</strong>可一次性指定多种内容编码。如gzip、compress…。</li>
<li><strong>Accept-Language</strong>：<strong>该首部字段用来告知服务器用户代理能够处理的自然语言集，以及自然语言集的相对优先级。</strong>可一次指定多种自然语言集。</li>
<li><strong>Authorization</strong>：<strong>该首部字段用来告知服务器，用户代理的认证信息。</strong>通常，想要通过服务器认证的用户代理在接收到返回的401状态码响应后，把首部字段Authorization加入请求中。</li>
<li><strong>Expect</strong>：<strong>客户端使用Expect首部字段告知服务器，期望出现的某种特定行为。因服务器无法理解客户端的期望做出回应而发生错误时，会返回状态码417 Expectation Failed。等待状态码100响应的客户端在发生请求时，需要指定Expect：100-continue。</strong></li>
<li><strong>Form</strong>：<strong>用来告知服务器使用用户代理的用户的电子邮件地址。</strong>通常其使用目的就是为了显示搜索引擎等用户代理的负责人的电子邮件联系方式。</li>
<li><strong>Host</strong>：<strong>该首部字段会告知服务器，请求的资源所处的互联网主机名和端口号。Host首部字段在HTTP/1.1规范内是唯一一个必须被包含在请求内的首部字段。</strong></li>
<li><strong>If-Match</strong>：<strong>形如If-xxx这种样式的请求首部字段，都可称为条件请求。服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求。该首部字段会告知服务器匹配资源所用的实体标记（ETag）值，仅当两者一致时，才会执行请求，反之返回状态码412 Precondition Failed的响应。</strong></li>
<li><strong>If-Modified-Since</strong>：<strong>该首部字段会告知服务器若该字段值早于资源的更新时间，则希望能处理该请求。如果在该字段值的日期时间之后，请求的资源都没有更新过，则返回状态码304 Not Modified响应。</strong></li>
<li><strong>If-None-Match</strong>：<strong>它和首部字段If-Match作用相反，</strong>用于指定字段值的实体标记（ETag）值与请求资源的ETag不一致时，它就告知服务器处理该请求。</li>
<li><strong>If-Range</strong>：<strong>它告知服务器若指定的If-Range字段值和请求资源的ETag值或时间相一致时，则作范围请求处理，反之则返回全体资源。</strong></li>
<li><strong>If-Unmodified-Since</strong>：它与首部字段If-Modified-Since的作用相反。</li>
<li><strong>Max-Forwards</strong>：<strong>通过TRACE方法或OPTIONS方法，发送包含首部字段Max-Forwards的请求时，该字段以十进制整数形式指定可经过的服务器最大数目。</strong></li>
<li><strong>Proxy-Authorization</strong>：接收到从代理服务器发来的认证质询时，客户端会发送包含该首部字段的请求，以告知服务器认证所需的信息。</li>
<li><strong>Range</strong>：<strong>对于只需获取部分资源的范围请求，包含该首部字段即可告知服务器资源的指定范围。接收到附带Range首部字段请求的服务器，会在处理请求之后返回状态码206 Partial Content。无法处理该范围请求时，则会返回状态码200 OK的响应及全部资源。</strong></li>
<li><strong>Referer</strong>：它会告知服务器请求的原始资源的URI。</li>
<li><strong>TE</strong>：它会告知服务器客户端能够处理响应的传输编码方式及相对优先级，和Accept-Encoding很像，但是用于传输编码。</li>
<li><strong>User-Agent</strong>：<strong>该首部字段会将创建请求的浏览器和用户代理名称等信息传达给服务器。</strong></li>
</ul>
<h2 id="响应首部字段"><a href="#响应首部字段" class="headerlink" title="响应首部字段"></a>响应首部字段</h2><p>响应首部字段是由服务器向客户端返回响应报文中所使用的字段，用于补充响应的附加信息、服务器信息，以及对客户端的附加要求等信息。</p>
<ul>
<li><strong>Accept-Ranges</strong>：<strong>该首部字段是用来告知客户端服务器是否能够处理范围请求，以指定获取服务器端某个部分的资源。可指定的字段值有两种，可处理范围请求时指定其为byte，反之则指定为none；</strong></li>
<li><strong>Age</strong>：告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。</li>
<li><strong>ETag</strong>：告知客户端实体标识，它是一种可将资源以字符串形式做唯一性表示的方式。服务器会为每份资源分配对应的ETag值。<ul>
<li><strong>强ETag</strong>：不论实体发生多么细微的变化都会改变其值。</li>
<li><strong>若ETag</strong>：只用于提示资源是否相同，只有资源发生了根本改变才会变该其值。会在字段值最开始附加W/。</li>
</ul>
</li>
<li><strong>Location</strong>：<strong>可将响应接收方引导至某个与请求URI位置不同的资源。基本上会配合3xx：Redirecting的响应，提供重定向的URI。</strong></li>
<li><strong>Proxy-Authenticate</strong>：会把由代理服务器所要求的认证信息发送给客户端。</li>
<li><strong>Retry-After</strong>：<strong>告知客户端多久之后再次发送请求。主要配和状态码503 Service Unavailabl使用。</strong></li>
<li><strong>Server</strong>：<strong>告知客户端当前服务器上安装的HTTP服务器应用程序的信息，</strong>不单会标出服务器上的软件应用名称，还有可能包括版本号和安装时启用的可选项。</li>
<li><strong>Vary</strong>：可对缓存进行控制。源服务器会向代理服务器传达关于本地缓存使用方法的命令。</li>
<li><strong>WWW-Authenticate</strong>：告知客户端适用于访问请求URI所指定资源的认证方案和带参数提示的质询。<strong>状态码401 Unauthorized响应中，肯定带有该首部字段。</strong></li>
</ul>
<h2 id="实体首部字段"><a href="#实体首部字段" class="headerlink" title="实体首部字段"></a>实体首部字段</h2><p>实体首部字段是包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等与实体相关的信息。</p>
<ul>
<li><strong>Allow</strong>：<strong>用于通知客户端能够支持Request-URI指定资源的所有HTTP方法。当服务器接收到不支持的HTTP方法时，会以状态码405 Method Not Allowed作为响应返回，同时还会把所有能支持的HTTP方法写入首部字段Allow后返回。</strong></li>
<li><strong>Content-Encoding</strong>：<strong>告知客户端服务器对实体的主体部分选用的内容编码。如gzip、compress等。</strong></li>
<li><strong>Content-Language</strong>：告知客户端实体主体使用的自然语言。</li>
<li><strong>Content-Length</strong>：表明实体主体部分的大小，单位是字节。<strong>当编码传输时，则不能使用Content-Length首部字段。</strong></li>
<li><strong>Content-Location</strong>：给出与报文主体部分相对应的URI。</li>
<li><strong>Content-MD5</strong>：该字段值是一串由MD5算法生成的值，目的在于检查报文主体在传输过程中是否保持完整，以及确认传输到达。</li>
<li><strong>Content-Range</strong>：针对范围请求，返回响应时使用的首部字段Content-Range，能告知客户端作为响应返回的哪个部分符合范围请求。</li>
<li><strong>Content-Type</strong>：<strong>说明实体主体内对象的媒体类型，和Accept一样。</strong></li>
<li><strong>Expires</strong>：<strong>会将资源失效的日期告知客户端，缓存服务器在接收到含有首部字段Expires的响应后，会以缓存来应答请求，在到该该值指定时间之前，响应的副本会一直被保存。当首部字段Cache-Control有指定max-age指令时，会优先处理max-age指令。</strong></li>
<li><strong>Last-Modified</strong>：指明资源最终修改的时间。</li>
</ul>
<h2 id="为Cookie服务的首部字段"><a href="#为Cookie服务的首部字段" class="headerlink" title="为Cookie服务的首部字段"></a>为Cookie服务的首部字段</h2><p>Cookie的工作机制是用户识别及状态管理。Web网站为了管理用户的状态会通过Web浏览器，把一些临时数据写入用户的计算机内。接着当用户访问该Web网站时，可通过通信方式取回之前存放的Cookie。</p>
<table>
<thead>
<tr>
<th align="center">首部字段名</th>
<th align="center">说明</th>
<th align="center">首部类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Set-Cookie</td>
<td align="center">开始状态管理所使用的Cookie信息</td>
<td align="center">响应首部字段</td>
</tr>
<tr>
<td align="center">Cookie</td>
<td align="center">服务器接收到的Cookie信息</td>
<td align="center">请求首部字段</td>
</tr>
</tbody></table>
<ul>
<li><strong>Set-Cookie</strong>：下标列举了Set-Cookie的字段值<img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191104221710.png" alt></li>
<li><strong>Cookie</strong>：会告知服务器，当客户端想获得HTTP状态管理支持时，就会在请求中包含从服务器接收到的Cookie。</li>
</ul>
<h1 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h1><p>在HTTP协议中有可能存在信息窃听或身份伪装等安全问题。使用HTTPS通信机制可以有效地防止这些问题。</p>
<h2 id="HTTP的缺点"><a href="#HTTP的缺点" class="headerlink" title="HTTP的缺点"></a>HTTP的缺点</h2><p>到目前为止，已经了解了HTTP具有相当优秀和方便的一面，然而HTTP并非只有好的一面，它也有不足之处：</p>
<ul>
<li><strong>通信使用明文（不加密），内容可能会被窃听。</strong></li>
<li><strong>不验证通信方的身份，因此有可能遭遇伪装。</strong></li>
<li><strong>无法证明报文的完整性，所以有可能已遭篡改。</strong></li>
</ul>
<h2 id="HTTPS是身披SSL外壳的HTTP"><a href="#HTTPS是身披SSL外壳的HTTP" class="headerlink" title="HTTPS是身披SSL外壳的HTTP"></a>HTTPS是身披SSL外壳的HTTP</h2><p>HTTPS的加密方式就是通信加密。HTTP协议中没有加密机制，但可以通过和SSL或TLS的组合使用，加密HTTP的通信内容。</p>
<p>用SSL建立安全通信线路之后，就可以在这条线路上进行HTTP通信了，与SSL组合使用的HTTP被称为HTTPS。因此HTTPS并非应用层的一种新协议，知识HTTP通信接口部分用SSL和TLS协议代替而已。</p>
<p><strong>通常，HTTP直接与TCP通信。当使用SSL时，则变成先和SSL通信，再由SSL和TCP通信了，简言之，所谓HTTPS就是身披着SSL协议这层外壳的HTTP。</strong></p>
<p>在采用SSL后，HTTP就拥有了HTTPS的加密、证书和完整性保护这些功能。SSL是独立于HTTP的协议，所以不光是HTTP协议，其他运行在应用层的SMTP和Telnet等协议均可配合SSL协议使用。</p>
<h2 id="HTTPS加密过程"><a href="#HTTPS加密过程" class="headerlink" title="HTTPS加密过程"></a>HTTPS加密过程</h2><p>HTTPS使用非对称加密，具体过程如下：</p>
<ol>
<li><strong>服务端先把自己的公钥（key1）发给证书颁发机构，向证书颁发机构申请证书。</strong></li>
<li><strong>证书颁发机构也有自己的一对公钥私钥，机构使用自己的私钥来加密key1，并且通过服务端网址等信息生成一个数字签名信息，证书签名同样经过机构的私钥加密。证书制作完成后，把这个证书返回给服务端。</strong></li>
<li><strong>当客户端向服务端请求通信时，服务端把自己申请的证书返回给客户端。</strong></li>
<li><strong>客户端收到证书以后，要做的第一件事情就是验证证书的真伪性。因为各大浏览器和操作系统已经维护了所有权威证书机构的名称和公钥，所以客户端根据证书颁发的机构，使用那个机构的公钥对证解密，书上的数字签名进行验证。</strong></li>
<li><strong>客户端对证书验证成功后，就可以放心的再次利用机构公钥，解密出服务端的公钥key1。</strong></li>
<li><strong>客户端生成自己的对称加密密钥key2，并且用服务端的公钥key1加密key2，发送给服务端。</strong></li>
<li><strong>服务端使用自己的私钥解密，得到对称加密的密钥key2，于是客户端与服务端之间开始使用key2进行对称加密的通信。</strong></li>
</ol>
<h2 id="HTTPS也有缺点"><a href="#HTTPS也有缺点" class="headerlink" title="HTTPS也有缺点"></a>HTTPS也有缺点</h2><p>HTTPS也存在一些问题，那就是当使用SSL时，它的处理速度会变慢。<strong>SSL的慢分为两种：一种是指通信慢，另一种是指由于大量消耗CPU及内存等资源，导致处理速度变慢。</strong></p>
<p>和使用HTTP相比，网络负载可能会变慢2到100倍，<strong>除去和TCP连接、发送HTTP请求/响应以外，还必须进行SSL通信，因此整体上处理通信量不可避免会增加。</strong></p>
<p><strong>另一点就是SSL必须进行加密处理。在服务器和客户端都需要进行加密和解密的运算处理，因此从结果上来讲，比起HTTP会更多的消耗服务器和客户端的硬件资源，导致负载增强。</strong></p>
<h1 id="基于HTTP的功能追加协议"><a href="#基于HTTP的功能追加协议" class="headerlink" title="基于HTTP的功能追加协议"></a>基于HTTP的功能追加协议</h1><p>虽然HTTP协议简单又简捷，但随着时代的发展，其功能使用上捉襟见肘的疲态已经凸显，因此下面将讲解一下基于HTTP新增的功能的协议。</p>
<h2 id="SPDY"><a href="#SPDY" class="headerlink" title="SPDY"></a>SPDY</h2><p>Google在2010年发布了SPDY（取自speedy），其开发目标旨在解决HTTP的性能瓶颈，缩短Web页面的加载时间（50%）。若想在现有Web实现所需的功能，以下这些HTTP标准就会成为瓶颈：</p>
<ul>
<li>一条连接上只可发送一个请求。</li>
<li>请求只能从客户端开始，客户端不可以接收除响应以外的指令。</li>
<li>请求/响应首部未经压缩就发送，首部信息越多延迟越大。</li>
<li>发送冗长的首部，每次互相发送相同的首部造成的浪费较多。</li>
<li>可任意选择数据压缩格式，非强制压缩发送。</li>
</ul>
<h3 id="长轮询与短轮询"><a href="#长轮询与短轮询" class="headerlink" title="长轮询与短轮询"></a>长轮询与短轮询</h3><p>长轮询与短轮询是基于Ajax实现的解决办法，使用局部刷新的方法可以达到实时更新的效果，但是依旧没有解决HTTP协议本身的问题。</p>
<ul>
<li><strong>长轮询</strong>:<strong>长轮询是服务器收到请求后如果有数据，立刻响应请求；如果没有数据，就会保持连接一段时间，这段时间内如果有数据立刻响应请求，如果时间到了还没有数据，则响应HTTP请求。浏览器在收到请求后，再立刻发送一个同样HTTP请求查询是否有数据。</strong>长轮询的局限在与：<ul>
<li><strong>浏览器对同一服务器同时HTTP连接有最大限制，最好同一用户只存在一个长轮询。</strong></li>
<li><strong>服务端没有数据时，保持连接时会造成浪费，容易产生服务器瓶颈。</strong></li>
</ul>
</li>
<li><strong>短轮询</strong>：<strong>短轮询是服务器收到请求时不管是否有数据都直接响应HTTP请求，浏览器收到HTTP响应隔一段时间后，再发送同样的HTTP请求查询是否有数据。HTTP短轮询的局限性在于实时性相对低一些。</strong></li>
</ul>
<h3 id="Comet的解决办法"><a href="#Comet的解决办法" class="headerlink" title="Comet的解决办法"></a>Comet的解决办法</h3><p>一旦服务器有内容更新，Comet不会让请求等待，而是直接给客户端返回响应，<strong>这是一种通过延迟应答，模拟实现服务器端向客户端推送的功能。</strong></p>
<p>通常，服务器端接收到请求，在处理完毕后就会立即返回响应，<strong>但为了实现推送功能，Comet会先将响应置于挂起状态，当服务器端有内容更新时，再返回该响应。</strong>因此，服务端一旦有更新，就可以立即反馈给客户端。</p>
<p><strong>内容上虽然可以做到实时更新，但为了保留响应，一次连接的持续时间也变长了。</strong>期间，为了维持连接会消耗更多的资源。另外，Comet也仍未解决HTTP协议本身的问题。</p>
<h3 id="SPDY的设计与功能"><a href="#SPDY的设计与功能" class="headerlink" title="SPDY的设计与功能"></a>SPDY的设计与功能</h3><p>处于持续开发状态中的SPDY协议，正是为了在协议级别消除HTTP所遭遇的瓶颈。SPDY没有完全改写HTTP协议，而是在TCP/IP的应用层与传输层之间通过新加会话层的形式运作。<strong>同时考虑到安全性问题，SPDY规定通信中使用SSL。</strong></p>
<p>SPDY以会话层的形式加入，控制对数据的流动，但还是采用HTTP建立通信连接，因此可照常使用HTTP的GET和POST等方法、Cookie以及HTTP报文等。<img src="/posts/62018/TIM%E6%88%AA%E5%9B%BE20191106180112.png" alt><br>使用SPDY后，HTTP协议额外获得以下功能：</p>
<ul>
<li><strong>多路复用流</strong>：<strong>通过单一的TCP连接，可以无限制处理多个HTTP请求，所有请求的处理都在一条TCP连接上完成，</strong>因此TCP的处理效率得到提高。</li>
<li><strong>赋予请求优先级</strong>：SPDY不仅可以无限制的并发处理请求，还可以给请求逐个分配优先级顺序。这样主要是为了在发送多个请求时，<strong>解决因带宽低而导致响应变慢的问题。</strong></li>
<li><strong>压缩HTTP首部</strong>：<strong>压缩HTTP请求和响应的首部</strong>，这样通信产生的数据包流量和发送的字节数就更少了。</li>
<li><strong>推送功能</strong>：<strong>支持服务器主动向客户端推送数据的功能，</strong>这样服务器就可直接发送数据，而不必等待客户端的请求。</li>
<li><strong>服务器提示功能</strong>：<strong>服务器可以主动提示客户端请求所需的资源。</strong>由于在客户端发现资源之前就可以获知资源的存在，因此在资源已缓存等情况下，<strong>可以避免发送不必要的请求。</strong></li>
</ul>
<h2 id="全双工通信的WebSocket"><a href="#全双工通信的WebSocket" class="headerlink" title="全双工通信的WebSocket"></a>全双工通信的WebSocket</h2><p>WebSocket视野更独立的协议标准，即Web浏览器与Web服务器之间全双工通信标准，一旦Web服务器与客户端之间建立起WebSocket协议的通信连接，之后所有的通信都依靠这个专用协议进行。通信过程中可互相发送JSON、XML、HTML或图片的等任意格式的数据。</p>
<p><strong>由于是建立在HTTP基础上的协议，因此连接的发起方仍是客户端，而一但确立WebSocket通信连接，不论服务器还是客户端，任意一方都可直接向对方发送报文。</strong>下面是WebSocket协议的主要特点：</p>
<ul>
<li><strong>推送功能</strong>：<strong>支持由服务器向客户端推送数据的推送功能，</strong>这样服务器可直接发送数据，而不必等待客户端的请求。</li>
<li><strong>减少通信量</strong>：<strong>只要建立起WebSocket连接，就希望一直保持连接状态</strong>。和HTTP相比，<strong>不但每次连接时的总开销减少，而且由于WebSocket的首部信息很小，通信量也相应减小了。</strong></li>
</ul>
<h2 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP/2.0"></a>HTTP/2.0</h2><p>HTTP/2.0的目标是改善用户在使用Web是的速度体验，HTTP/2.0围绕着主要的7项技术进行讨论，现阶段大都倾向于采用以下协议的技术：</p>
<ul>
<li><strong>多路复用</strong></li>
<li><strong>TLS义务化</strong></li>
<li><strong>协商</strong></li>
<li><strong>客户端拉拽/服务器推送</strong></li>
<li><strong>流量控制</strong></li>
<li><strong>WebSocket</strong></li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/2668/" rel="next" title="HTTP协议介绍">
                <i class="fa fa-chevron-left"></i> HTTP协议介绍
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/posts/47572/" rel="prev" title="海量数据处理">
                海量数据处理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="gitalk-container">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Potato">
            
              <p class="site-author-name" itemprop="name">Potato</p>
              <div class="site-description motion-element" itemprop="description">Although the road is endless and faraway, I still want to pursue the truth in the world.</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Potato-xupt" title="GitHub &rarr; https://github.com/Potato-xupt" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:401242993@qq.com" title="E-Mail &rarr; mailto:401242993@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP状态码"><span class="nav-number">1.</span> <span class="nav-text">HTTP状态码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2XX成功"><span class="nav-number">1.1.</span> <span class="nav-text">2XX成功</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3XX重定向"><span class="nav-number">1.2.</span> <span class="nav-text">3XX重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4XX客户端错误"><span class="nav-number">1.3.</span> <span class="nav-text">4XX客户端错误</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5XX服务器错误"><span class="nav-number">1.4.</span> <span class="nav-text">5XX服务器错误</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#与HTTP协作的Web服务器"><span class="nav-number">2.</span> <span class="nav-text">与HTTP协作的Web服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#代理"><span class="nav-number">2.1.</span> <span class="nav-text">代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#网关"><span class="nav-number">2.2.</span> <span class="nav-text">网关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#隧道"><span class="nav-number">2.3.</span> <span class="nav-text">隧道</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#保存资源的缓存"><span class="nav-number">2.4.</span> <span class="nav-text">保存资源的缓存</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP首部"><span class="nav-number">3.</span> <span class="nav-text">HTTP首部</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#通用首部字段"><span class="nav-number">3.1.</span> <span class="nav-text">通用首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cache-Control"><span class="nav-number">3.1.1.</span> <span class="nav-text">Cache-Control</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connection"><span class="nav-number">3.1.2.</span> <span class="nav-text">Connection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Date"><span class="nav-number">3.1.3.</span> <span class="nav-text">Date</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pragma"><span class="nav-number">3.1.4.</span> <span class="nav-text">Pragma</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Trailer"><span class="nav-number">3.1.5.</span> <span class="nav-text">Trailer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Transfer-Encoding"><span class="nav-number">3.1.6.</span> <span class="nav-text">Transfer-Encoding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Upgrade"><span class="nav-number">3.1.7.</span> <span class="nav-text">Upgrade</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Via"><span class="nav-number">3.1.8.</span> <span class="nav-text">Via</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Warning"><span class="nav-number">3.1.9.</span> <span class="nav-text">Warning</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求首部字段"><span class="nav-number">3.2.</span> <span class="nav-text">请求首部字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#响应首部字段"><span class="nav-number">3.3.</span> <span class="nav-text">响应首部字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实体首部字段"><span class="nav-number">3.4.</span> <span class="nav-text">实体首部字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#为Cookie服务的首部字段"><span class="nav-number">3.5.</span> <span class="nav-text">为Cookie服务的首部字段</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTPS"><span class="nav-number">4.</span> <span class="nav-text">HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP的缺点"><span class="nav-number">4.1.</span> <span class="nav-text">HTTP的缺点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS是身披SSL外壳的HTTP"><span class="nav-number">4.2.</span> <span class="nav-text">HTTPS是身披SSL外壳的HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS加密过程"><span class="nav-number">4.3.</span> <span class="nav-text">HTTPS加密过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS也有缺点"><span class="nav-number">4.4.</span> <span class="nav-text">HTTPS也有缺点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基于HTTP的功能追加协议"><span class="nav-number">5.</span> <span class="nav-text">基于HTTP的功能追加协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SPDY"><span class="nav-number">5.1.</span> <span class="nav-text">SPDY</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#长轮询与短轮询"><span class="nav-number">5.1.1.</span> <span class="nav-text">长轮询与短轮询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Comet的解决办法"><span class="nav-number">5.1.2.</span> <span class="nav-text">Comet的解决办法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SPDY的设计与功能"><span class="nav-number">5.1.3.</span> <span class="nav-text">SPDY的设计与功能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#全双工通信的WebSocket"><span class="nav-number">5.2.</span> <span class="nav-text">全双工通信的WebSocket</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-2-0"><span class="nav-number">5.3.</span> <span class="nav-text">HTTP/2.0</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  
    <div id="sidebar-dimmer"></div>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Potato</span>

  

  
</div>







<div>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style="display:none">
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style="display:none">
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>



        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>



  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  
  <script src="/js/js.cookie.js?v=7.2.0"></script>
  <script src="/js/scroll-cookie.js?v=7.2.0"></script>


  

  

  


  
    

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">



<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '9b0c87d3c176c7c8ae2f',
    clientSecret: 'c1a521ad426a42ab0a65b5d65a33e27303274435',
    repo: 'comments',
    owner: 'Potato-xupt',
    admin: ['Potato-xupt'],
    id: md5(location.pathname),
    
      language: window.navigator.language || window.navigator.userLanguage,
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
